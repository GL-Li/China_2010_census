{
    "collab_server" : "",
    "contents" : "##### plot for house ==========================================================\nlibrary(ggplot2)\nload(\"house.RData\")\n\n### preprocess data\n# order 受教育程度 for better plot\nhouseEduCombined$受教育程度 <- factor(houseEduCombined$受教育程度,\n                                 ordered = TRUE,\n                                 levels = houseEduCombined$受教育程度[1:7])\n# add new column in Chinese\ntranslateWhere <- c(\"城市\", \"乡镇\", \"农村\")\nnames(translateWhere) <- c(\"city\", \"town\", \"village\")\nhouseEduCombined$城乡 <- translateWhere[houseEduCombined$where]\nhouseEduCombined$城乡 <- factor(houseEduCombined$城乡, ordered = TRUE,\n                              levels = c(\"城市\", \"乡镇\", \"农村\"))\nhouseEduCombined$户数 <- houseEduCombined$number_of_household / 10000\n\n# set up theme for ggplot\nmyThemeAxis <- theme(axis.title = element_text(size = 12),\n                     axis.text = element_text(size = 11, color = \"black\"),\n                     legend.text=element_text(size=11))\n\n# make plot\nggplot(houseEduCombined, aes(受教育程度, area_per_person)) +\n    geom_line(aes(group = where, color = 城乡), alpha = 0.6) + \n    geom_point(aes(size = 户数, color = 城乡), alpha = 0.6) +\n    expand_limits(y = c(23.8, 44.2)) +\n    scale_y_continuous(breaks = seq(24, 44, 4)) +\n    scale_size(\"户数（万）\", range = c(0.5, 15)) + \n    scale_color_manual(\"居住地\", values = c(\"城市\" = \"blue\", \"乡镇\" = \"green\",\n                                  \"农村\" = \"red\")) +\n    xlab(\"户主受教育程度\") +\n    ylab(expression(人均住房面积~(m^2))) +\n    ggtitle(\"2010年第六次人口普查：住房和教育\") +\n    annotate(\"text\", x = Inf, y = -Inf, label = \"武达盟\",\n             hjust=1.1, vjust=-1.1, col=\"white\", cex=6,\n             fontface = \"bold\", alpha = 0.8)\n\nggsave(filename = \"house_vs_edu.png\", width = 6, height = 4)\n\n\n### 各类教育程度人口在同龄人口中的比例 =========================================\nload(\"eduCombined.RData\")\n\n# convert to long table\nlibrary(tidyr)\neduLong <- gather(eduCombined, 教育程度, 人口, -c(age, population, sex, birth, where))\n\n# 新增列 - 同龄人口中的比例\neduLong$比例 <- 100 * eduLong$人口 /eduLong$population \n\n# 数值换成中文\nsexToChinese <- c(\"男\", \"女\")\nnames(sexToChinese) <- c(\"male\", \"female\")\neduLong$性别 <- sexToChinese[eduLong$sex]\neduLong$性别 <- factor(eduLong$性别, ordered = TRUE, levels = c(\"男\", \"女\"))\n\neduLevelToChinese <- c(\"未上过学\", \"小学\", \"初中\", \"高中\", \n                       \"大学专科\", \"大学本科\", \"研究生\")\nnames(eduLevelToChinese) <- c(\"no_school\", \"elementary_school\", \"middle_school\",\n                              \"high_school\", \"specialized_college\",\n                              \"university\", \"graduate_school\")\neduLong$教育程度 <- eduLevelToChinese[eduLong$教育程度]\neduLong$教育程度 <- factor(eduLong$教育程度, ordered = TRUE,\n                       levels = c(\"未上过学\", \"小学\", \"初中\", \"高中\", \n                                  \"大学专科\", \"大学本科\", \"研究生\"))\n\nwhereToChinese <- c(\"城市\", \"乡镇\", \"农村\")\nnames(whereToChinese) <- c(\"city\", \"town\", \"village\")\neduLong$居住地 <- whereToChinese[eduLong$where]\neduLong$居住地 <- factor(eduLong$居住地, ordered = TRUE,\n                      levels = c(\"城市\", \"乡镇\", \"农村\"))\n\n\n\nggplot(eduLong, aes(age, 比例)) + \n    geom_line(aes(color = 性别)) + \n    geom_point(aes(color = 性别), size = 0.3) +\n    facet_grid(居住地 ~ 教育程度) +\n    ggtitle(\"2010年第六次人口普查：最终学历的演化\") + \n    xlab(\"年龄\") + \n    ylab(\"同龄人口中的比例 (%)\") +\n    theme(legend.position = c(1, 1), \n          legend.justification = c(1, 1),\n          legend.title = element_blank())\n\nggsave(filename = \"education_population_age.png\", width = 6, height = 4)\n",
    "created" : 1467978860145.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2524717670",
    "id" : "1961C425",
    "lastKnownWriteTime" : 1468254271,
    "last_content_update" : 1468254271030,
    "path" : "~/Dropbox/my_R_projects/China_2010_cencus/plot_not_for_shiny/make_plot.R",
    "project_path" : "make_plot.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}